<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Side Quest: An Auth System for Django Ninja | Bhargav Singapuri</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://majulahsingapuri.github.io/blog/django-ninja-auth/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Side Quest: An Auth System for Django Ninja | Bhargav Singapuri"><meta data-rh="true" name="description" content="A REST Authentication System for the Django Ninja Framework"><meta data-rh="true" property="og:description" content="A REST Authentication System for the Django Ninja Framework"><meta data-rh="true" name="keywords" content="backend,python,django,django-ninja,auth,authentication,REST,JWT,cookies,session,github"><meta data-rh="true" property="og:image" content="https://github.com/majulahsingapuri.png"><meta data-rh="true" name="twitter:image" content="https://github.com/majulahsingapuri.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-12-12T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/majulahsingapuri"><meta data-rh="true" property="article:tag" content="backend,django,django-ninja,authentication,python"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://majulahsingapuri.github.io/blog/django-ninja-auth/"><link data-rh="true" rel="alternate" href="https://majulahsingapuri.github.io/blog/django-ninja-auth/" hreflang="en"><link data-rh="true" rel="alternate" href="https://majulahsingapuri.github.io/blog/django-ninja-auth/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bhargav Singapuri RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bhargav Singapuri Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Bhargav Singapuri JSON Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S3K30Y4N2K"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S3K30Y4N2K",{})</script><link rel="stylesheet" href="/assets/css/styles.aae1dd54.css">
<script src="/assets/js/runtime~main.40b11e03.js" defer="defer"></script>
<script src="/assets/js/main.1ebd05a6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/bhargav.png" alt="My Site Logo" class="avatar__photo avatar__photo--sm themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/bhargav.png" alt="My Site Logo" class="avatar__photo avatar__photo--sm themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Bhargav Singapuri</b></a><a class="navbar__item navbar__link" href="/projects/">Projects</a><a class="navbar__item navbar__link" href="/ninja-auth/">Ninja Auth</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/majulahsingapuri" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub Profile"></a><a href="https://linkedin.com/in/bhargav-singapuri" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link" aria-label="LinkedIn Profile"></a><a href="https://twitter.com/majulasingapuri" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link" aria-label="Twitter Profile"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Read More</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/django-ninja-auth/">Side Quest: An Auth System for Django Ninja</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/personal-expenses-pt-3/">Personal Expenses Pt. 3</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/personal-expenses-pt-2/">Personal Expenses Pt. 2</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/personal-expenses-pt-1/">Personal Expenses Pt. 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/prompt-engineering/">Prompt Engineering for Context Understanding</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="A REST Authentication System for the Django Ninja Framework"><link itemprop="image" href="https://github.com/majulahsingapuri.png"><meta itemprop="keywords" content="backend,python,django,django-ninja,auth,authentication,REST,JWT,cookies,session,github"><header><h1 class="title_f1Hy" itemprop="headline">Side Quest: An Auth System for Django Ninja</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-12-12T00:00:00.000Z" itemprop="datePublished">December 12, 2023</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/majulahsingapuri" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/majulahsingapuri.png" alt="Bhargav Singapuri" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/majulahsingapuri" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Bhargav Singapuri</span></a></div><small class="avatar__subtitle" itemprop="description">SWE and Data Scientist</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Creating the perfect (imo at least) REST authentication system for Django Ninja</p>
<p>Hello one and all and welcome back to another update!
I hope you are all having a wonderful holiday season.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-start-a-new-project">Why Start a New Project<a href="#why-start-a-new-project" class="hash-link" aria-label="Direct link to Why Start a New Project" title="Direct link to Why Start a New Project">​</a></h2>
<p>In the process of creating my auth server, I have decided to do a little side quest and expand upon an <a href="https://eadwincode.github.io/django-ninja-jwt/" target="_blank" rel="noopener noreferrer">exisiting library</a> for authentication in Django Ninja REST framework called <code>django-ninja-jwt</code>.
Why would I do such a thing?
Isn&#x27;t there already too much on my plate that I have to go and add on a new project?</p>
<p>Firstly, yes.
I do have too many projects on my plate, considering that an auth server is just the first step in the process.
I still have to create the whole personal finance app, or whatever I end up creating in the end.
But at the same time, I personally have been pretty frustrated with the lack of REST authentication options for Django Ninja.
Yes, the base library provides a decent start for Session, Cookie and token authentication, it is not as robust as Django REST Framework.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-django-ninja-jwt">Why Django-Ninja-JWT<a href="#why-django-ninja-jwt" class="hash-link" aria-label="Direct link to Why Django-Ninja-JWT" title="Direct link to Why Django-Ninja-JWT">​</a></h2>
<p>The library that I ended up forking does provide great support for JWT authentication but does not support any other kinds of cookie authentication.
But what it did have is a great system for customisations to the controllers and schemas as well as a working JWT authentication system that is symmetric to <a href="https://github.com/iMerica/dj-rest-auth" target="_blank" rel="noopener noreferrer">Django REST Auth</a>.
Hence, all I had to do was to port over the Token Authentication capability from DRA and add in the basic session authentication functionality and we are golden.</p>
<p>While I did remove some of the functionality from the JWT part of the project, namely the token blacklisting and routers for simplicity&#x27;s sake, it is not difficult to re-incorporate it back into the project.
The key thing was to ensure that it had compatibility with Pydantic&#x27;s v2 API while maintianing the same functionality.</p>
<p>What I also liked from the DRA and Ninja JWT libraries is that there sub-apps that extend the base app&#x27;s functionality.
For DRA it is the <code>authtoken</code> app and for Ninja JWT it is the <code>blacklist</code> app.
This means that all I have to do is to keep the core authentication logic in the main app and add any other logic like checking of tokens and creating refresh endpoints in sub-apps.
This ensures that there is a top-down hierarchy and developers only use what they need.</p>
<p>What I ended up with is the <a href="https://pypi.org/project/dj-ninja-auth/" target="_blank" rel="noopener noreferrer">following</a> library.</p>
<p><img decoding="async" loading="lazy" alt="dj-ninja-auth project page" src="/assets/images/dj-ninja-auth-project-page-3ab6f93d6ebcbe6adcf1fbbd60113693.png" width="1146" height="655" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<p>Using an email and password for authentication is so old school.
Where is the good stuff? We need social authentication and since security is also important, we need to add in MFA.
Luckily, <a href="https://github.com/pennersr/django-allauth/tree/main" target="_blank" rel="noopener noreferrer">Allauth</a> already provides these functionalities, albeit for apps that are fully managed by Django rather than being on the REST architecture.
This means that there will have to be some tweaking and bodging that has to be done in order to allow this to work properly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="goal">Goal<a href="#goal" class="hash-link" aria-label="Direct link to Goal" title="Direct link to Goal">​</a></h2>
<p>At the end of the day, my goal for this project is for it to be a fully fledged authentication system that provides support for all kinds of authentication, be it username/password or social and with MFA support built on JWTs or rotating Auth tokens.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-you-can-do">What You can Do<a href="#what-you-can-do" class="hash-link" aria-label="Direct link to What You can Do" title="Direct link to What You can Do">​</a></h2>
<p>Every open source project needs time and manpower to keep up to date.
This repository is already 2 departed from the original SimpleJWT library and me being the only contributor will take considerable effort on my end.
If you find this library useful, want to get started with open source or think there are ways that I can improve the code (workflows, actions, tests) then do feel free to create PRs and help expand this project.</p>
<p>Thank you for your time and I hope you learnt something!</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/backend/">backend</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/django/">django</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/django-ninja/">django-ninja</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/authentication/">authentication</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/python/">python</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/personal-expenses-pt-3/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Personal Expenses Pt. 3</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-start-a-new-project" class="table-of-contents__link toc-highlight">Why Start a New Project</a></li><li><a href="#why-django-ninja-jwt" class="table-of-contents__link toc-highlight">Why Django-Ninja-JWT</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li><li><a href="#goal" class="table-of-contents__link toc-highlight">Goal</a></li><li><a href="#what-you-can-do" class="table-of-contents__link toc-highlight">What You can Do</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More Socials</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://instagram.com/majulahsingapuri" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://tiktok.com/@majulahs" target="_blank" rel="noopener noreferrer" class="footer__link-item">TikTok<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://majulahsingapuri.substack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Substack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:hello@bhargav.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Bhargav Singapuri. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>