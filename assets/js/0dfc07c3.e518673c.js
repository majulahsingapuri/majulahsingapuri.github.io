"use strict";(self.webpackChunkmajulahsingapuri_github_io=self.webpackChunkmajulahsingapuri_github_io||[]).push([[3811],{7968:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>s,metadata:()=>r,toc:()=>h});var n=a(5893),o=a(1151);const s={id:"fyp",title:"Final Year Project",description:"This was my Final Year Project done at Vertex",sidebar_position:1,sidebar_label:"FYP",keywords:["final year project","fyp","ntu","data science","machine learning"],image:"https://github.com/majulahsingapuri.png",slug:"fyp",tags:["final year project","fyp","ntu","data science","machine learning"],draft:!1},i=void 0,r={id:"Internship/fyp",title:"Final Year Project",description:"This was my Final Year Project done at Vertex",source:"@site/projects/Internship/FYP.md",sourceDirName:"Internship",slug:"/Internship/fyp",permalink:"/projects/Internship/fyp",draft:!1,unlisted:!1,tags:[{label:"final year project",permalink:"/projects/tags/final-year-project"},{label:"fyp",permalink:"/projects/tags/fyp"},{label:"ntu",permalink:"/projects/tags/ntu"},{label:"data science",permalink:"/projects/tags/data-science"},{label:"machine learning",permalink:"/projects/tags/machine-learning"}],version:"current",sidebarPosition:1,frontMatter:{id:"fyp",title:"Final Year Project",description:"This was my Final Year Project done at Vertex",sidebar_position:1,sidebar_label:"FYP",keywords:["final year project","fyp","ntu","data science","machine learning"],image:"https://github.com/majulahsingapuri.png",slug:"fyp",tags:["final year project","fyp","ntu","data science","machine learning"],draft:!1},sidebar:"tutorialSidebar",previous:{title:"NTU STARS",permalink:"/projects/School/mystars/"}},l={},h=[{value:"Background",id:"background",level:2},{value:"Project Motivation",id:"project-motivation",level:3},{value:"Goals",id:"goals",level:3},{value:"The Journey",id:"the-journey",level:2},{value:"Data",id:"data",level:3},{value:"Expansive",id:"expansive",level:4},{value:"Multiple Languages",id:"multiple-languages",level:4},{value:"Skews in Categories",id:"skews-in-categories",level:4},{value:"Model",id:"model",level:3},{value:"Training",id:"training",level:3},{value:"Deployment",id:"deployment",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",strong:"strong",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsx)(t.p,{children:"Some details have been intentionally omitted."})}),"\n",(0,n.jsx)(t.h2,{id:"background",children:"Background"}),"\n",(0,n.jsx)(t.p,{children:"As a part of my degree course, I had to undertake a year-long project that would constitute my honours thesis.\nI was fortunate enough that I was a part of a Work-Study Degree program where I was allowed to undertake the project at a company of my choice.\nThe goal of the program was to allow students like myself to have relevant, long-term industry experience that would be helpful to us for our careers."}),"\n",(0,n.jsx)(t.h3,{id:"project-motivation",children:"Project Motivation"}),"\n",(0,n.jsx)(t.p,{children:"As I was interning at a Venture Capital company, the main problem that they faced was to ingest relevant data and process it so that they can make smart investment decisions based on the data gathered.\nThis is a multi-part problem that requires many components that build on top of other components.\nSince the company was interested in categorising the companies that they are interested in by the industry that they are in, so that they can better target their investment and business development opportunities, my goal was to create some system that does this automatically."}),"\n",(0,n.jsx)(t.h3,{id:"goals",children:"Goals"}),"\n",(0,n.jsx)(t.p,{children:"At the end of the day, I was to create some sort of machine learning model that would take the company's description, which gives rich information of what the company does, and classifies it into a set of fixed categories.\nThis would be a natural language model that would be fine tuned to relevant data and deployed to an API that makes it easy for the company to incorporate it into their products and services."}),"\n",(0,n.jsx)(t.h2,{id:"the-journey",children:"The Journey"}),"\n",(0,n.jsx)(t.h3,{id:"data",children:"Data"}),"\n",(0,n.jsx)(t.p,{children:"Luckily in this regard, the company had sourced data about over 60 million companies which included their names, descriptions and their industries.\nThis was the perfect starting point as this is a labelled dataset that can be used for supervised learning.\nThe main problem with this data was that it was so expansive, covered multiple languages and had skews in the categories that it represented."}),"\n",(0,n.jsx)(t.h4,{id:"expansive",children:"Expansive"}),"\n",(0,n.jsx)(t.p,{children:"Most of the time, the problem is that we don't have enough data, but I seemed to have the opposite problem.\nHow can I train my model on all 60 million data points?\nHow long will that take?\nIs the data even complete or are there missing values?\nIf so, how to fill them?"}),"\n",(0,n.jsxs)(t.p,{children:["At the end of the day, what we want is for the model to train in the most effective way possible and learn the most that it can from the data.\nUpon looking through the data, I saw that almost ",(0,n.jsx)(t.strong,{children:"half"})," the data had missing values and thus could be discarded \ud83e\udee0."]}),"\n",(0,n.jsx)(t.h4,{id:"multiple-languages",children:"Multiple Languages"}),"\n",(0,n.jsxs)(t.p,{children:["This was an interesting problem as our target use case was for it to be purely in english, since the target users were all english-speaking.\nHowever, the problem was detecting what is the language of the description.\nThere are models on ",(0,n.jsx)(t.a,{href:"https://huggingface.co/models?search=language%20detection",children:"Huggingface"})," that can detect languages but it only works for 20 languages that might not be enough for the variance in the dataset."]}),"\n",(0,n.jsx)(t.p,{children:"Google does provide an API that runs their own model that does the language detection but that API costs money and it would not be prudent to rack up charges without any good reason.\nIn the end I just decided to use models that supported a wide variety of languages to ensure that there would be no issues in the training and all the datapoints that I have available can be used."}),"\n",(0,n.jsx)(t.h4,{id:"skews-in-categories",children:"Skews in Categories"}),"\n",(0,n.jsx)(t.p,{children:"This was by far the biggest issue as there is no way that there will be an equal representation of all the various industries in the dataset.\nAdditionally, the industries that are present might not be representative of the areas that my company invests in.\nHowever, the goal is still to create a classifier that performs well at the task of classification rather than focus on the segments of the industry that the company focusses on."}),"\n",(0,n.jsx)(t.h3,{id:"model",children:"Model"}),"\n",(0,n.jsxs)(t.p,{children:["The obvious answer at that point in the project was to use a Transformer model and fine tune it to the dataset.\nIn doing so, a lot of data pre-processing can be replaced by the humble ",(0,n.jsx)(t.code,{children:"Tokenizer"}),".\nThere are also ready-made and highly performant language models that are available for everyone to use on Huggingface.\nThe only question was about the model size, which affects the training and inference speed, as well as the model architecture."]}),"\n",(0,n.jsx)(t.p,{children:"I chose a subset of the models and aimed to fine tune them all on a reduced dataset to see which combination of model name and size, batch size and various other hyperparameters gives the best result for the given task."}),"\n",(0,n.jsx)(t.h3,{id:"training",children:"Training"}),"\n",(0,n.jsx)(t.p,{children:"After some struggle with AWS customer support, I was able to set up a training environment with 4 NVIDIA T4 GPUs that would compete an epoch in just under... 18 hours.\nFortunately, the data was sufficiently randomised and so the training would start to converge after about 8 hours and would eventually stop at the best possible loss value.\nHowever given the sheer number of variables in the grid search that I was conducting, I had over 60 experiments to run to try and find the optimal model."}),"\n",(0,n.jsx)(t.p,{children:"We also came to realise that some models performed better at a subset of the labels while others performed better at another subset.\nWe realised that we will have to ensemble these models together in order for us to have an even more accurate model.\nThis posed its own challenges as the architectures, and thus the tokenisers for the model was different, and thus the same piece of text had to be tokenised multiple times and the whole model was extremely large in size.\nThis further slowed down training but eventually I managed to reach a model that was sufficiently accurate for our use cases."}),"\n",(0,n.jsx)(t.h3,{id:"deployment",children:"Deployment"}),"\n",(0,n.jsx)(t.p,{children:"The eventual goal was for this model to be deployed as an API that the company's platform can call and get results from.\nHowever due to unforseen delays and complications, I didn't manage to deploy the model.\nThere was also the release of ChatGPT that seemed to be able to perform decently well that the company explored using that instead."}),"\n",(0,n.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(t.p,{children:"This was definitely an interesting learning experience given that I had never previously worked with such a scale of data, such models or even the tools that I used for the project.\nIt was really eye opening to the entire process flow that various teams in the AI/ML pipeline go through (that I had to undertake alone) in order for the final model to be as performant as possible, since we all know that Garbage In is Garbage Out.\nTo be able to deliver some sort of a working product was more than rewarding enough for me and I hope to be able to use this knowledge going forward for further personal projects or for work."})]})}function c(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,a)=>{a.d(t,{Z:()=>r,a:()=>i});var n=a(7294);const o={},s=n.createContext(o);function i(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);